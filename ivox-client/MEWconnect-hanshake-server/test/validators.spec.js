import chai from 'chai';
import validator from '../src/validators'

const assert = chai.assert;

describe('usingRedis.test.js', function() {

  // test cases
  it('offerSignal', function(done) {
    const input = ["offerSignal",{"data":{"iv":{"type":"Buffer","data":[73,2,17,226,172,183,198,83,206,224,210,158,15,183,119,20]},"ephemPublicKey":{"type":"Buffer","data":[4,71,32,206,47,115,102,68,201,242,247,73,38,186,42,65,241,94,187,59,216,163,244,198,91,63,210,123,221,8,109,168,235,243,106,199,22,58,45,135,182,63,156,94,175,101,212,75,152,138,254,238,74,15,138,192,187,15,217,2,27,147,123,56,78]},"ciphertext":{"type":"Buffer","data":[211,144,112,137,162,222,41,232,187,118,21,24,189,62,99,202,229,86,176,101,134,103,191,128,128,254,50,27,137,170,64,158,53,149,140,54,141,110,250,151,226,38,28,242,59,138,247,212,165,218,106,58,160,246,201,139,222,255,159,230,17,120,55,251,251,51,179,155,224,12,59,156,66,91,42,187,180,38,81,91,154,91,211,221,78,27,64,132,199,63,230,139,178,72,140,81,48,32,92,99,126,132,40,157,83,238,41,248,62,135,40,142,129,52,79,234,72,219,16,215,212,177,86,247,227,74,54,92,102,167,213,128,224,8,196,97,208,89,187,70,118,126,189,101,93,254,177,95,84,184,61,132,185,14,170,232,105,108,100,57,116,240,37,215,216,32,23,28,228,232,170,30,220,65,48,149,241,184,22,48,248,8,138,104,30,171,226,168,45,158,167,233,49,254,2,193,137,180,111,77,144,58,141,76,204,7,153,235]},"mac":{"type":"Buffer","data":[183,49,114,4,226,243,112,204,102,45,49,98,118,164,255,226,242,82,24,213,47,64,149,18,169,1,134,183,61,14,64,66]}},"connId":"8df6dfbc1d13e402eb0fb894e1b2abd124"}]

    validator(input)
      .then( result => {
        assert.isTrue(result)
        done()
      })
  });


  it('answerSignal', function(done) {
    const input =   ["answerSignal",{"data":{"iv":{"type":"Buffer","data":[83,65,71,19,75,4,165,114,247,158,247,234,37,108,41,37]},"ephemPublicKey":{"type":"Buffer","data":[4,12,45,252,196,1,190,67,179,34,211,247,49,119,127,158,104,143,3,30,19,197,55,174,225,182,101,95,216,182,111,47,149,49,120,181,145,205,63,202,14,216,37,153,89,211,234,133,251,122,61,225,108,182,115,236,176,19,51,200,115,36,134,117,34]},"ciphertext":{"type":"Buffer","data":[51,245,212,117,23,85,174,244,249,149,252,193,140,140,108,93,200,167,141,109,181,211,65,20,240,65,219,9,208,213,184,29,140,35,42,12,14,247,99,180,210,227,7,250,89,29,108,210,160,161,49,207,229,106,160,214,189,95,3,7,74,184,222,36,2,217,111,15,179,89,131,138,117,125,150,8,76,119,169,194,239,125,98,37,199,182,112,210,148,10,158,229,229,151,93,96,48,218,179,165,147,145,95,39,118,127,150,171,119,137,248,203,145,201,101,115,161,225,113,19,173,28,194,3,34,42,171,222,214,25,144,216,206,37,19,121,231,236,237,135,175,62,18,82,147,10,171,157,19,159,221,215,74,37,133,54,79,109,254,119,140,232,91,156,173,171,115,109,230,144,96,231,218,255,227,60]},"mac":{"type":"Buffer","data":[115,32,103,115,18,209,82,150,233,200,217,177,255,156,2,5,166,127,83,152,85,227,159,253,182,144,89,186,131,35,119,92]}},"connId":"8df6dfbc1d13e402eb0fb894e1b2abd124"}]

    validator(input)
      .then( result => {
        assert.isTrue(result)
        done()
      })
  });

  it('options as a string', function(done) {
    const input = ["offerSignal",{"data":{"iv":{"type":"Buffer","data":[73,2,17,226,172,183,198,83,206,224,210,158,15,183,119,20]},"ephemPublicKey":{"type":"Buffer","data":[4,71,32,206,47,115,102,68,201,242,247,73,38,186,42,65,241,94,187,59,216,163,244,198,91,63,210,123,221,8,109,168,235,243,106,199,22,58,45,135,182,63,156,94,175,101,212,75,152,138,254,238,74,15,138,192,187,15,217,2,27,147,123,56,78]},"ciphertext":{"type":"Buffer","data":[211,144,112,137,162,222,41,232,187,118,21,24,189,62,99,202,229,86,176,101,134,103,191,128,128,254,50,27,137,170,64,158,53,149,140,54,141,110,250,151,226,38,28,242,59,138,247,212,165,218,106,58,160,246,201,139,222,255,159,230,17,120,55,251,251,51,179,155,224,12,59,156,66,91,42,187,180,38,81,91,154,91,211,221,78,27,64,132,199,63,230,139,178,72,140,81,48,32,92,99,126,132,40,157,83,238,41,248,62,135,40,142,129,52,79,234,72,219,16,215,212,177,86,247,227,74,54,92,102,167,213,128,224,8,196,97,208,89,187,70,118,126,189,101,93,254,177,95,84,184,61,132,185,14,170,232,105,108,100,57,116,240,37,215,216,32,23,28,228,232,170,30,220,65,48,149,241,184,22,48,248,8,138,104,30,171,226,168,45,158,167,233,49,254,2,193,137,180,111,77,144,58,141,76,204,7,153,235]},"mac":{"type":"Buffer","data":[183,49,114,4,226,243,112,204,102,45,49,98,118,164,255,226,242,82,24,213,47,64,149,18,169,1,134,183,61,14,64,66]}},"connId":"8df6dfbc1d13e402eb0fb894e1b2abd124", options: 'something'}]

    validator(input)
      .then( result => {
        assert.isTrue(result)
        done()
      })
  });

  it('options as an array', function(done) {
    const input = ["offerSignal",{"data":{"iv":{"type":"Buffer","data":[73,2,17,226,172,183,198,83,206,224,210,158,15,183,119,20]},"ephemPublicKey":{"type":"Buffer","data":[4,71,32,206,47,115,102,68,201,242,247,73,38,186,42,65,241,94,187,59,216,163,244,198,91,63,210,123,221,8,109,168,235,243,106,199,22,58,45,135,182,63,156,94,175,101,212,75,152,138,254,238,74,15,138,192,187,15,217,2,27,147,123,56,78]},"ciphertext":{"type":"Buffer","data":[211,144,112,137,162,222,41,232,187,118,21,24,189,62,99,202,229,86,176,101,134,103,191,128,128,254,50,27,137,170,64,158,53,149,140,54,141,110,250,151,226,38,28,242,59,138,247,212,165,218,106,58,160,246,201,139,222,255,159,230,17,120,55,251,251,51,179,155,224,12,59,156,66,91,42,187,180,38,81,91,154,91,211,221,78,27,64,132,199,63,230,139,178,72,140,81,48,32,92,99,126,132,40,157,83,238,41,248,62,135,40,142,129,52,79,234,72,219,16,215,212,177,86,247,227,74,54,92,102,167,213,128,224,8,196,97,208,89,187,70,118,126,189,101,93,254,177,95,84,184,61,132,185,14,170,232,105,108,100,57,116,240,37,215,216,32,23,28,228,232,170,30,220,65,48,149,241,184,22,48,248,8,138,104,30,171,226,168,45,158,167,233,49,254,2,193,137,180,111,77,144,58,141,76,204,7,153,235]},"mac":{"type":"Buffer","data":[183,49,114,4,226,243,112,204,102,45,49,98,118,164,255,226,242,82,24,213,47,64,149,18,169,1,134,183,61,14,64,66]}},"connId":"8df6dfbc1d13e402eb0fb894e1b2abd124", options: ['something']}]

    validator(input)
      .then( result => {
        assert.isTrue(result)
        done()
      })
  });

  it('options as an object', function(done) {
    const input = ["offerSignal",{"data":{"iv":{"type":"Buffer","data":[73,2,17,226,172,183,198,83,206,224,210,158,15,183,119,20]},"ephemPublicKey":{"type":"Buffer","data":[4,71,32,206,47,115,102,68,201,242,247,73,38,186,42,65,241,94,187,59,216,163,244,198,91,63,210,123,221,8,109,168,235,243,106,199,22,58,45,135,182,63,156,94,175,101,212,75,152,138,254,238,74,15,138,192,187,15,217,2,27,147,123,56,78]},"ciphertext":{"type":"Buffer","data":[211,144,112,137,162,222,41,232,187,118,21,24,189,62,99,202,229,86,176,101,134,103,191,128,128,254,50,27,137,170,64,158,53,149,140,54,141,110,250,151,226,38,28,242,59,138,247,212,165,218,106,58,160,246,201,139,222,255,159,230,17,120,55,251,251,51,179,155,224,12,59,156,66,91,42,187,180,38,81,91,154,91,211,221,78,27,64,132,199,63,230,139,178,72,140,81,48,32,92,99,126,132,40,157,83,238,41,248,62,135,40,142,129,52,79,234,72,219,16,215,212,177,86,247,227,74,54,92,102,167,213,128,224,8,196,97,208,89,187,70,118,126,189,101,93,254,177,95,84,184,61,132,185,14,170,232,105,108,100,57,116,240,37,215,216,32,23,28,228,232,170,30,220,65,48,149,241,184,22,48,248,8,138,104,30,171,226,168,45,158,167,233,49,254,2,193,137,180,111,77,144,58,141,76,204,7,153,235]},"mac":{"type":"Buffer","data":[183,49,114,4,226,243,112,204,102,45,49,98,118,164,255,226,242,82,24,213,47,64,149,18,169,1,134,183,61,14,64,66]}},"connId":"8df6dfbc1d13e402eb0fb894e1b2abd124", options: {}}]

    validator(input)
      .then( result => {
        assert.isTrue(result)
        done()
      })
  });

  it('options as an number', function(done) {
    const input = ["offerSignal",{"data":{"iv":{"type":"Buffer","data":[73,2,17,226,172,183,198,83,206,224,210,158,15,183,119,20]},"ephemPublicKey":{"type":"Buffer","data":[4,71,32,206,47,115,102,68,201,242,247,73,38,186,42,65,241,94,187,59,216,163,244,198,91,63,210,123,221,8,109,168,235,243,106,199,22,58,45,135,182,63,156,94,175,101,212,75,152,138,254,238,74,15,138,192,187,15,217,2,27,147,123,56,78]},"ciphertext":{"type":"Buffer","data":[211,144,112,137,162,222,41,232,187,118,21,24,189,62,99,202,229,86,176,101,134,103,191,128,128,254,50,27,137,170,64,158,53,149,140,54,141,110,250,151,226,38,28,242,59,138,247,212,165,218,106,58,160,246,201,139,222,255,159,230,17,120,55,251,251,51,179,155,224,12,59,156,66,91,42,187,180,38,81,91,154,91,211,221,78,27,64,132,199,63,230,139,178,72,140,81,48,32,92,99,126,132,40,157,83,238,41,248,62,135,40,142,129,52,79,234,72,219,16,215,212,177,86,247,227,74,54,92,102,167,213,128,224,8,196,97,208,89,187,70,118,126,189,101,93,254,177,95,84,184,61,132,185,14,170,232,105,108,100,57,116,240,37,215,216,32,23,28,228,232,170,30,220,65,48,149,241,184,22,48,248,8,138,104,30,171,226,168,45,158,167,233,49,254,2,193,137,180,111,77,144,58,141,76,204,7,153,235]},"mac":{"type":"Buffer","data":[183,49,114,4,226,243,112,204,102,45,49,98,118,164,255,226,242,82,24,213,47,64,149,18,169,1,134,183,61,14,64,66]}},"connId":"8df6dfbc1d13e402eb0fb894e1b2abd124", options: 0}]

    validator(input)
      .then( result => {
        assert.isFalse(result)
        done()
      })
  });

  it('options as an function', function(done) {
    const input = ["offerSignal",{"data":{"iv":{"type":"Buffer","data":[73,2,17,226,172,183,198,83,206,224,210,158,15,183,119,20]},"ephemPublicKey":{"type":"Buffer","data":[4,71,32,206,47,115,102,68,201,242,247,73,38,186,42,65,241,94,187,59,216,163,244,198,91,63,210,123,221,8,109,168,235,243,106,199,22,58,45,135,182,63,156,94,175,101,212,75,152,138,254,238,74,15,138,192,187,15,217,2,27,147,123,56,78]},"ciphertext":{"type":"Buffer","data":[211,144,112,137,162,222,41,232,187,118,21,24,189,62,99,202,229,86,176,101,134,103,191,128,128,254,50,27,137,170,64,158,53,149,140,54,141,110,250,151,226,38,28,242,59,138,247,212,165,218,106,58,160,246,201,139,222,255,159,230,17,120,55,251,251,51,179,155,224,12,59,156,66,91,42,187,180,38,81,91,154,91,211,221,78,27,64,132,199,63,230,139,178,72,140,81,48,32,92,99,126,132,40,157,83,238,41,248,62,135,40,142,129,52,79,234,72,219,16,215,212,177,86,247,227,74,54,92,102,167,213,128,224,8,196,97,208,89,187,70,118,126,189,101,93,254,177,95,84,184,61,132,185,14,170,232,105,108,100,57,116,240,37,215,216,32,23,28,228,232,170,30,220,65,48,149,241,184,22,48,248,8,138,104,30,171,226,168,45,158,167,233,49,254,2,193,137,180,111,77,144,58,141,76,204,7,153,235]},"mac":{"type":"Buffer","data":[183,49,114,4,226,243,112,204,102,45,49,98,118,164,255,226,242,82,24,213,47,64,149,18,169,1,134,183,61,14,64,66]}},"connId":"8df6dfbc1d13e402eb0fb894e1b2abd124", options: function(){}}]

    validator(input)
      .then( result => {
        assert.isFalse(result)
        done()
      })
  });

  // it('Update single entry ', function(done) {
  //
  //
  // });
  //
  // it('Update turn state entry ', function(done) {
  //
  //
  // });
  //
  // it('Removes a single entry ', function(done) {
  //
  //
  // });
});
